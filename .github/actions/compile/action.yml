name: Build
description: Build carl
inputs: 
  CC: 
    description: 'The C compiler to use'
    required: true
    default: ""
  CXX:
    description: 'The C++ compiler to use'
    required: true
    default: ""
outputs:
  build-dir:
    description: "The build directory"
    value: ${{github.workspace}}/build

runs:
  using: "composite"
  steps:
    - name: Configure CMake
      shell: bash
      run: |
        echo "::group::Configure CMake"
        echo "Build directory: ${{github.workspace}}/build"
        echo "Build type: ${{env.BUILD_TYPE}}"
        echo "CC: ${{inputs.CC}}"
        echo "CXX: ${{inputs.CXX}}"
        export CC=${{inputs.CC}} CXX=${{inputs.CXX}}
        cmake -B ${{github.workspace}}/build -DCMAKE_BUILD_TYPE=${{env.BUILD_TYPE}}
        echo "::group::Configure CMake done"
    - name: Build carl
      shell: bash
      run: |
        echo "::group::Build carl"
        cmake --build ${{github.workspace}}/build --config ${{env.BUILD_TYPE}} --target all -j$(nproc)
        echo "::group::Build carl done"
